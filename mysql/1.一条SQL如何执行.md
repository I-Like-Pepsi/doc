# 一条SQL如何执行

## 连接器

负责跟客户端建立连接、获取权限、维持和管理连接

## 查询缓存

之前经过的语句及结果可能会以Key-Value对的形式被缓存到内存中。如果后续查询命中缓存，则会直接返回操作结果。

但是大多数情况下不建议使用查询缓存，只要对一个表进行更新，那么针对该表的查询缓存就会失效。在更新频繁的情况下，查询缓存往往利大于弊。在8.0的版本之后该功能被删除了。

## 分析器

如果上一步没有命中缓存，就开始真正的执行SQL语句了。分析器会做词法分析，例如对于“select”这个关键词分析出你要做的是一个查询。

做完词法分析之后就要做语法分析。根据词法分析结果，语法分析器会根据语法判断规则判断你输入的SQL语句是否满足Mysql语法。

## 优化器

经过分析器Mysql知道你要做什么了，在开始执行之前，要先经过优化器的处理。优化器是在表里存在多个索引的时候，决定使用哪个索引。或者一个语句有多表关联的时候决定各个表的连接顺序。

## 执行器

经过分析器知道了你要做什么，通过优化器知道了该怎么做，于是就进入了执行阶段，开始执行语句。

在开始执行的时候先判断你对这个表有没有执行的权限，如果没有会返回权限错误。如果有权限，执行器会根据表的引擎定义去使用这个引擎的接口执行。
